import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.Random;

import facebook4j.Facebook;
import facebook4j.FacebookException;
import facebook4j.FacebookFactory;
import facebook4j.IdNameEntity;
import facebook4j.ResponseList;
import facebook4j.User;
import facebook4j.auth.AccessToken;

/**
 * 
 */

/**
 * @author samiconn
 *
 */
public class CollecFBUID {

	/**
	 * @param args
	 * @throws IOException 
	 * @throws InterruptedException 
	 */
	
	public static void searchUser(Facebook facebook) throws FacebookException, IOException, InterruptedException {
		File file =  new File("sample.txt");
		File fuid = new File("fuid.txt");
		int counter = 0;
		
		
		BufferedReader reader = new BufferedReader(new FileReader(file));
		
		while (true) {
			
			
				String line = reader.readLine();
				
			if (line == null)
			{
				break;
			}
			System.out.println(line);
			
			if (line.length() != 0) {
			ResponseList<User> results = facebook.searchUsers(line);
			BufferedWriter writer = new BufferedWriter(new FileWriter(fuid, true));
			for (int i = 0; i < results.size(); i++) {
				counter = counter+1;
				
				User us = results.get(i);
				String id = us.getId();
				String username = us.getName();
							
				System.out.println(counter+". "+ id +" "+" "+username);
				writer.append(id);
				writer.append("\r\n");
				
			}
			writer.close();
			}
			Random rd = new Random();
			int time = 1000*rd.nextInt(10);
			Thread.sleep(time);
		}
		
		reader.close();
		
		BufferedWriter writer = new BufferedWriter(new FileWriter(fuid, true));
		writer.append(Integer.toString(counter));
		writer.close();
		
	}
	
	public static void getInfor(Facebook facebook, File file) throws IOException, FacebookException {
				
		BufferedReader reader = new BufferedReader(new FileReader(file));
		
		while (true) {
			
			String line = reader.readLine();
			User results  = facebook.getUser(line);
			System.out.println(results.getName() +" - " + results.getEmail());
			
		}
		
	}
	
	public static void main(String[] args) throws IOException, FacebookException, InterruptedException {
		// TODO Auto-generated method stub
		String appId = "1604980453116311 : autobotsam" ;
		String appSecret = "1a802d7abbf1cfb769b7dec010d40c27";
		String commaSeparetedPermissions = "user_birthday, user_religion_politics, user_relationships, user_relationship_details, user_hometown, user_location, user_likes, user_education_history, user_work_history, user_website, user_managed_groups, user_events, user_photos, user_videos, user_friends, user_about_me, user_status, user_games_activity, user_tagged_places, user_posts, read_page_mailboxes, rsvp_event, email, ads_management, ads_read, read_insights, manage_pages, publish_pages, publish_actions, read_custom_friendlists, user_actions.books, user_actions.music, user_actions.video, user_actions.news, user_actions.fitness, public_profile, read_stream";
		String accessToken = "CAAWzuKHHiZAcBAHKkRefE8KGQjUgzKojzyYTGqnqs6Ndkd1gff6xuQR2MFCTFgkB49gmjZAMuR2a2lH5KFwwSM8Yy9ABscZAat6eAuuq8lldM9XKqsYQ2xCj09AhcMBHBRXNI41P6TXn1ZAOcKiTsUs7nUDiIGDSBPADZByH3xtyA9zBsY0F5Oj3GMMXJ4g5U3ICsh8vtWQZDZD";
		File file  = new File("fuid.txt");
		Facebook facebook = new FacebookFactory().getInstance();
		facebook.setOAuthAppId(appId, appSecret);
		facebook.setOAuthPermissions(commaSeparetedPermissions);
		facebook.setOAuthAccessToken(new AccessToken(accessToken));
		
		//Action list call
			
			//searchUser(facebook);
			getInfor(facebook,file);
			
			
	
		
	}
}
