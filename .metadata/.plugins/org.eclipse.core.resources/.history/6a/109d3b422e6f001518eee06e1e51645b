package epubRead;

import java.awt.print.Book;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.List;

import nl.siegmann.epublib.domain.Resource;
import nl.siegmann.epublib.domain.Spine;
import nl.siegmann.epublib.domain.SpineReference;
import nl.siegmann.epublib.epub.EpubReader;

public class epubRead {
	
	   public static String getText(String filepath) {

		    String linez = "";
		    File f = new File(filepath);

		    InputStream epubInputStream = null;
		    try {
		        epubInputStream = new FileInputStream(f);
		    } catch (FileNotFoundException e2) {
		        // TODO Auto-generated catch block
		        e2.printStackTrace();
		    }

		    nl.siegmann.epublib.domain.Book book = null;
		    try {
		        book = (new EpubReader()).readEpub(epubInputStream);
		    } catch (IOException e1) {
		        // TODO Auto-generated catch block
		        e1.printStackTrace();
		    }

		    Spine spine = book.getSpine();
		    List<SpineReference> spineList = spine.getSpineReferences();
		    int count = spineList.size();
		    
			txtpages.setText("Size:" + Integer.toString(count) + "\n");
		    StringBuilder string = new StringBuilder();
		    for (int i = 0; count > i; i++) {
		        Resource res = spine.getResource(i);

		        try {
		            InputStream is = res.getInputStream();
		            BufferedReader reader = new BufferedReader(
		                    new InputStreamReader(is));
		            try {
		            	String line = null;
		                while ((line = reader.readLine()) != null) {
		                    linez = string.append(line + "\n").toString();
		                    
		                }

		            } catch (IOException e) {
		                e.printStackTrace();
		            }

		            // do something with stream
		            
		        } catch (IOException e) {
		            e.printStackTrace();
		        }

		    }

		    //webView.loadData(linez, "text/html", "utf-8");


		    return linez;
		}
	   
	   public static void main(String[] args) {
		   
		   
		   System.out.println(getText("Ba ngày luân lạc - Lê Văn Trương.epub"));
		   
	   } 

}
